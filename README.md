# flr2mmcif
The python script converts the information in the filled spreadsheet template to a mmcif file for PDB-IHM. 
This includes the part for the fluorescence (flrCIF) dictionary [![Hanke2024](https://img.shields.io/badge/DOI-10.1038%2Fs41592--024--02428--x-blue)](https://doi.org/10.1038/s41592-024-02428-x).

## Requirements
The script requires Python3 with ihm, and pandas installed.

## Usage

#### 1. Fill the spreadsheet (xls_template.xlsx). 
  * Please fill all tabs as complete as possible. Omitting important parts of the spreadsheet will result in failure of the script.
  * Each row has a unique ID in the first column. This has to be filled.
  * Please do not change the headers of the columns (in particular row 4). Thus, only rows from number 5 on should be modified and filled.
  * Please do not modify the names of the tabs in the spreadsheet, as the python script relies on the names.
  * Ideally fill the tabs from the first to the last, since some of the tabs provide selections based on the other tabs.

#### 2. Prepare an mmcif file for the atomic coordinates for the structural models.
  * Please make sure that the atomic coordinates are provided in the order of the models in the *Models* tab in the spreadsheet. This will not be checked by the conversion script.
  * The mmcif file must at least contain _atom_site entries. Additionally, _ihm_model_list, _ihm_model_group and _ihm_model_group_link entries can be provided and will then be used.

#### 3. Run the python script, e.g.

`python3 flr2mmcif.py --xls xls_example.xlsx --atoms atom_site_input_example.cif --cif output_filename.cif`

  Arguments for the script:
  * --xls or -x: The spreadsheet file based on the xls_template.xlsx
  * --atoms or -a: The cif file containing the _atom_site entries for the structural models.
  * --cif or -c: The name of the output file to be generated by the script.

#### 4. After generation, it is recommended to check the resulting mmcif file whether the output is what was expected.

## Documentation
An overview of the content in the spreadsheet can be found in [Documentation](/documentation/overview_collected_info_in_template.pdf)

## Citation
When using flr2mmcif, please cite the following publication [![Hanke2024](https://img.shields.io/badge/DOI-10.1038%2Fs41592--024--02428--x-blue)](https://doi.org/10.1038/s41592-024-02428-x)
> Hanke, C.A., Westbrook, J.D., Webb, B.M. et al. Making fluorescence-based integrative structures and associated kinetic information accessible. Nat Methods 21, 1970â€“1972 (2024); DOI: 10.1038/s41592-024-02428-x

## See also
The python-ihm package and the IHMCIF and flrCIF dictionaries can be found on https://github.com/ihmwg

PDB-IHM: https://pdb-ihm.org/
