# excel2mmcif
The python script converts the information in the filled excel template to a mmcif file for PDB-Dev. 
This includes the part for the fluorescence (FLR) dictionary.

## Requirements
The script requires Python3 with ihm, pandas, and xlrd installed.

## Usage

#### 1. Fill the excel sheet (excel_template.xlsx). 
  * Please fill all tabs as complete as possible. Omitting important parts of the excel sheet will result in failure of the script.
  * Each row has a unique ID in the first column. This has to be filled.
  * Please do not change the headers of the columns (in particular row 4). Thus, only rows from number 5 on should be modified and filled.
  * Please do not modify the names of the tabs in the excel sheet, as the python script relies on the names.
  * Ideally fill the tabs from the first to the last, since some of the tabs provide selections based on the other tabs.

#### 2. Prepare an mmcif file for the atomic coordinates for the structural models.
  * Please make sure that the atomic coordinates are provided in the order of the models in the *Models* tab in the excel sheet. This will not be checked by the conversion script.
  * The mmcif file must at least contain _atom_site entries. Additionally, _ihm_model_list, _ihm_model_group and _ihm_model_group_link entries can be provided and will then be used.

#### 3. Run the python script, e.g.

`python3 excel2mmcif.py --excel excel_example.xlsx --atoms atom_site_input_example.cif --cif output_filename.cif`

  Arguments for the script:
  * --excel or -e: The excel file based on the excel_template.xlsx
  * --atoms or -a: The cif file containing the _atom_site entries for the structural models.
  * --cif or -c: The name of the output file to be generated by the script.

#### 4. After generation, it is recommended to check the resulting mmcif file whether the output is what was expected.

## References
The python-ihm package and the IHM and FLR dictionaries can be found on https://github.com/ihmwg

PDB-Dev: https://pdb-dev.wwpdb.org/
